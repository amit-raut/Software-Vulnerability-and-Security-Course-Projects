####### README.md #######



- Model Builder (strTojsonModel.py)

The model builder generates the diagrams for the adjacent system calls from the trace file.
The model builder checks every line in the trace file and find the sys-calls to a python list.
Then the program prints the adjacent sys-calls to the console which can be redirected to the 
json file.

After dumping the output to a json file we need to do some work to validate the json file
like replacing "}" with "}," and removing the last comma. Finally we will generate the json file
which is an array of dictionary entries.

This json can be used as a signature for the IDS to detect malicious system calls from a program

The model builder generates the output as shown below

[{
    "syscall_2": "brk",
    "syscall_1": "execve"
},
//....
]


- Model Builder Augmented (straceTojsonAugmentedModel.py)

The augmented model is extension to the model builder defined earlier. It generates the output which list
the sys-calls along-with their arguments (initial pattern only). This augmented model can be fed to the IDS
to test the program for legal system call with arguments.

The json generated by the augmented model builder can be used as signature for the IDS.

The augmented model builder generates the output as shown below

[{
    "syscall_2_arg": "null",
    "syscall_2": "brk",
    "syscall_1": "execve",
    "syscall_1_arg": "./prset03"
},
//....
]

Checker (checker.py)

Checker program committed here works for checking the validity of the sys-calls from a programs.
The checker program takes 2 json file arguments, one is the solution.json which is like whitelist 
for the IDS and another which is json file for program which need to be validated.

Checker compares the dictionary values from the json file to be compared to the whitelist. If all the
values in the file comparison are correct then the execution of the program is authentic.
If the comparison fails then the checker will output the invalid sys-call and argument for it. 
Also it sets the flag is_malicious equal to True

For valid program checker will output the following 

{
    "malicious": false,
    "syscall": null,
    "syscall_arg": null
}

For a malicious program checker will output the following

{
    "syscall": "execve",
    "syscall_arg": "/bin//",
    "malicious": true
}

The above output shows that the malicious program tried to execute the /bin/bash script and it is caught 
by the checker.


- Mimicry attack based on Model builder (True)

The mimicry attack is possible if IDS only checks the adjacent system calls. The attacker can generate the 
specially crafted system call to match the IDS defined signatures. To perform this attacker could call to read()
system call and typically replaced by a call to mmap() followed by a memory access. In this way the attacker could 
fool the IDS in thinking that the malicious code is authentic.

Sometimes the IDS signatures does not include the trace for the forked system processes. In that scenario the attacker can create a forked process which will execute the actual exploit.

The IDS verification based on only diagrams of the system calls is not sufficient to catch the sophisticated attackers.


- Mimicry attack based on the Augmented Model builder (True)

The mimicry attack is still possible but much more difficult. Now the IDS not only checks for the adjacent system calls 
and the associated arguments to it. Unless the attacker has the signature used in the IDS it is almost impossible to perform 
mimicry attack. The attacker could use the use the same technique to match adjacent system calls. Here if you assume the 
attacker has knowledge of the signature in IDS he can use the system calls diagram pair which has null argument in order to
trick the IDS to run the exploit.

In case the attacker has no knowledge of the signature of IDS but can only get success/ failure result for the given exploit
then attacker can issue many chosen inputs to IDS and thereby build custom signature for the IDS. This is very difficult to 
achieve and will take lot of time and efforts.


