####### checker.py #######
__author__ = 'AR'

import sys, json

if len(sys.argv) < 3:
    print "Usage: Please specify at least 2 arguments."
    sys.exit()

whiteList = open(sys.argv[1], "r")
wlist = json.load(whiteList)

inputJson = open(sys.argv[2], "r")
inJson = json.load(inputJson)
is_malicious = False

def printResult(result):
    print json.dumps(result, ensure_ascii=True, indent=4, separators=(',', ': '))

for dict1 in inJson:
    if dict1 not in wlist:
        is_malicious = True
        parameters = {"malicious": is_malicious, "syscall": dict1["syscall_2"], "syscall_arg": dict1["syscall_2_arg"]}
        printResult(parameters)
        sys.exit()

is_malicious = False
parameters = {"malicious": is_malicious, "syscall": "null", "syscall_arg": "null"}
printResult(parameters)




