__author__ = 'AR'
import json, string, sys

#print "########## StraceToJson #########"
syscalls = []
sysdict = {}

if sys.argv < 2:
    print "Usage: Please specify strace file as an argument."
    sys.exit()

with open(sys.argv[1], "r") as f:
    for line in f:
        if string.ascii_lowercase.__contains__(line[6]) or string.ascii_uppercase.__contains__(line[6]):
            index = line.find("(")
            if index:
                syscall = line[6:index]
                syscalls.append(syscall)

for n in range(syscalls.__len__() - 2):
    sysdict.update({ "syscall_1":syscalls[n], "syscall_2":syscalls[n+1] })
    print json.dumps(sysdict, ensure_ascii=True, indent=4, separators=(',', ': '))

f.close()
