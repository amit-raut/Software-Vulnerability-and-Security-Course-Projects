############# decrypt.py #################
__author__ = 'AR'

import string, sys
from passlib.hash import des_crypt


des_hash = raw_input("Please enter DES hash to find the password: ")
if len(des_hash) != 13:
	print "ERROR: Invalid hash length."
	sys.exit()

print "Searching for possible password...."
ptext = "?"

for i in string.ascii_uppercase:
    ptext = ptext + i
    for j in string.ascii_uppercase:
        ptext = ptext + j
        for k in string.ascii_lowercase:
            ptext = ptext + k
            for l in string.ascii_lowercase:
                ptext = ptext + l
                for m in string.digits:
                    ptext = ptext + str(m)
                    for n in string.digits:
                        ptext = ptext + str(n)
                        ptext += "!"
                        if des_crypt.verify(ptext, des_hash):
				print 'Password Found: ' + ptext
			   	sys.exit()
			#print des_crypt.encrypt(ptext)
                        ptext = ptext[:-2]
                    ptext = ptext[:-1]
                ptext = ptext[:-1]
            ptext = ptext[:-1]
        ptext = ptext[:-1]
    ptext = ptext[:-1]


